---
layout: post
title: MCMC & Gibbs Sampling
description: 新系列(三)
category: blog
---

一般看完贝叶斯公式就应该开始Gibbs采样的相关学习了，但这个之前还要学习MCMC，所谓圆环套圆环啊。于是我看了两篇讲的不错的博客，首先可以看下[这篇](http://www.52nlp.cn/lda-math-mcmc-%E5%92%8C-gibbs-sampling1)，然后可以继续看下[这篇](http://www.cnblogs.com/xbinworld/p/4266146.html)。之前看过很多对冲基金就用的蒙特卡洛马尔柯夫模型，所以一开始看是充满了期待的。刚开始介绍了采样以及Box-Muller变换，虽然推不出来但还是可以接受的。然后就是学习马尔科夫链的收敛定理，一开始我是拒绝。为什么能发生这么神奇的事情，还不带证明过程的！

然后，我就思考了半个小时，考虑怎么让自己接受这个结果。在涂涂画画了半小时后，我突然发现了，原来是这个样子。其实，状态转移矩阵本身有一个隐含条件，那就是每一行的和值\\(\sum_{i=1}^{\infty}P_i=1\\)，所以整个收敛过程可以分成两个部分：  
1.从初始状态不断迭代为平稳状态     
2.稳定在平稳状态

第2部分其实很好理解，当一个矩阵P满足每一行和值为1，每一列的值都相等的条件，那么那就一定满足平稳状态的条件：\\(P^n\*P=P\*P^n=P\\)，然后根据隐含条件，一切都那么自然。   
关键是第1部分，为什么会收敛到平稳状态，而且这个形式是行和值为1，列值相等。当然大牛说了，证明过程比较复杂，所以我们以一个简单的例子还说明这个过程。从简单开始分析是一个比较好的方式，假设一个2\*2的状态矩阵P为[[m,1-m],[n,1-n]]，那么\\(P\*P=[[m^2+(1-m)\*n,1-n+mn-m^2],[mn+n-n^2,1-mn-n+n^2]]\\)，然后加一下每行的值，是不是等于1!由于\\(P^2\\)的形式也满足每行和值为1，然后就需要证明\\(P^n\\)的每行和值都为1。莫非，难道！于是我计算了一下[[p,1-p],[q,1-q]]\*[[m,1-m],[n,1-n]] 这样两个满足条件的通用形式结果，在看到了结果的刹那，我只能感叹数学之美，是的，每行和值为1。而且，隐约的觉得这跟共轭分布有点神似。行和值保持为1就可以接受了，而且为什么这么有意思的结果之前学矩阵论的时候没学过！第二个列值相等才是最核心的一个问题，为什么乘几次后会列值相等？想了一下还真有了个思路，其实这个问题可以转换为：假设m>n，相乘后的结果\\(m^2+(1-m)\*n\\)和\\(mn+n-n^2\\) 大于n，小于m。算一算就可以发现，还真是！所以经过多轮迭代同列的结果之间的距离会不断变小，直到相等！由此就可以理解：P最后会稳定收敛到[[p,1-p],[p,1-p]]，其中p为介于m和n之间的一个值。

然后根据细致平稳条件，我们还可以发现一个有意思的现象：最后平稳收敛后，从状态i跳转到状态j的数量等于从状态j跳转到状态i的数量。




[LinChaohui]:    http://www.linchaohui.com  "LinChaohui"
