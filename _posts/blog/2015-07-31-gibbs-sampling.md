---
layout: post
title: MCMC & Gibbs Sampling
description: 新系列(三)
category: blog
---

##马尔科夫链MC

一般看完贝叶斯公式就应该开始Gibbs采样的相关学习了，但这个之前还要学习MCMC，所谓圆环套圆环啊。于是我看了两篇讲的不错的博客，首先可以看下[这篇](http://www.52nlp.cn/lda-math-mcmc-%E5%92%8C-gibbs-sampling1)，然后可以继续看下[这篇](http://www.cnblogs.com/xbinworld/p/4266146.html)。之前看过很多对冲基金就用的蒙特卡洛马尔柯夫模型，所以一开始看是充满了期待的。刚开始介绍了采样以及Box-Muller变换，虽然推不出来但还是可以接受的。然后就是学习马尔科夫链的收敛定理，一开始我是拒绝。为什么能发生这么神奇的事情，还不带证明过程的！

然后，我就思考了半个小时，考虑怎么让自己接受这个结果。在涂涂画画了半小时后，我突然发现了，原来是这个样子。其实，状态转移矩阵本身有一个隐含条件，那就是每一行的和值\\(\sum_{i=1}^{\infty}P_i=1\\)，所以整个收敛过程可以分成两个部分：  
1.从初始状态不断迭代为平稳状态     
2.稳定在平稳状态

第2部分其实很好理解，当一个矩阵P满足每一行和值为1，每一列的值都相等的条件，那么那就一定满足平稳状态的条件：\\(P^n\*P=P\*P^n=P\\)，然后根据隐含条件，一切都那么自然。   
关键是第1部分，为什么会收敛到平稳状态，而且这个形式是行和值为1，列值相等。当然大牛说了，证明过程比较复杂，所以我们以一个简单的例子还说明这个过程。从简单开始分析是一个比较好的方式，假设一个2\*2的状态矩阵P为[[m,1-m],[n,1-n]]，那么\\(P\*P=[[m^2+(1-m)\*n,1-n+mn-m^2],[mn+n-n^2,1-mn-n+n^2]]\\)，然后加一下每行的值，是不是等于1!由于\\(P^2\\)的形式也满足每行和值为1，然后就需要证明\\(P^n\\)的每行和值都为1。莫非，难道！于是我计算了一下[[p,1-p],[q,1-q]]\*[[m,1-m],[n,1-n]] 这样两个满足条件的通用形式结果，在看到了结果的刹那，我只能感叹数学之美，是的，每行和值为1。而且，隐约的觉得这跟共轭分布有点神似。行和值保持为1就可以接受了，而且为什么这么有意思的结果之前学矩阵论的时候没学过！第二个列值相等才是最核心的一个问题，为什么乘几次后会列值相等？想了一下还真有了个思路，其实这个问题可以转换为：假设m>n，相乘后的结果\\(m^2+(1-m)\*n\\)和\\(mn+n-n^2\\) 大于n，小于m。算一算就可以发现，还真是！所以经过多轮迭代同列的结果之间的距离会不断变小，直到相等！由此就可以理解：P最后会稳定收敛到[[p,1-p],[p,1-p]]，其中p为介于m和n之间的一个值。

然后根据细致平稳条件: \\(π(i)\*P_{i,j}=π(j)\*P_{j,i}\\)，我们还可以发现一个有意思的现象：最后平稳收敛后，从状态i跳转到状态j的数量等于从状态j跳转到状态i的数量。

##蒙特卡洛方法MC

蒙特卡洛方法是一种随机模拟方法，随机模拟的思想由来已久，但是由于难于取得随机数，随机模拟的方法一直发展缓慢。而蒙特卡洛方法的出现得益于现代电子计算机的诞生，在1944年由Metropolis 和 Ulam提出于二战时美国原子弹研究的曼哈顿工程之中。蒙特卡洛这个名字是由Metropolis起的，借用了那个著名的赌场的名字，因为赌博总是和概率相关。

然后简单介绍下buffon投针计算π的过程，首先画了几根距离为d的平行线，然后用长度为l（l<d)的针随机投掷,统计针与平行线相交的概率为p，则\\(π=\frac{2l}/{pd}\\)。证明过程也很简单，但有一个小trick。首先相交的概率与针的长度是线性相关的，为什么呢，因为E(A+B)=E(A)+E(B)，一根针的相交概率等于把这根针细分成很多段的相交概率，所以kl=p，而k可以通过一种特殊情况计算出来。把针弯成一个圆且直径=d的时候（l=πd)，不管怎么投掷都是有两个交点的，所以k*πd=2。

##蒙特卡洛马尔科夫MCMC

ok，拖了几个月继续填坑。上面已经介绍了马尔科夫链具有稳态这种特性，所以当其达到平稳分布后，同时稳态的分布也是我们给定的分布，对其抽样就能生成符合我们想要分布的随机模拟数据了。所以MCMC的核心是：生成我们想要的分布的随机模拟数据。有什么用？开玩笑，很多贝叶斯估计的后验分布都是一些复杂积分，牛顿莱布尼兹根本搞不定，有了MCMC，贝叶斯方法才彻底牛逼起来了有木有。可以看下[这篇博客](http://www.cnblogs.com/xbinworld/p/4266146.html?utm_source=tuicool&utm_medium=referral)的蒙特卡洛数值积分方法。

Hastings-Metropolis算法就是一个基本的MCMC方法。


[LinChaohui]:    http://www.linchaohui.com  "LinChaohui"
